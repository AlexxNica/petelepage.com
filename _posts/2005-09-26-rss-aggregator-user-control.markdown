---
layout: post
title: RSS Aggregator User Control
date: '2005-09-26 06:56:00 -0400'
categories: blog
tags:
- MSDNBlogPost
comments: []
---

I think this is probably the last of the fun user controls that I created for my web sites, but this one was one of the more important ones for my [http://www.nocommonground.com](http://www.nocommonground.com/) website.&nbsp; When I created NoCommonGround, I wanted a site that would take all the info that I wanted, and put it into one place.&nbsp; I figured the easiest way to do that, was to integrate all the RSS feeds into one simple place.&nbsp; Thus, I needed an RSS feed user control.

There are a few bugs with this, I don't do complete checking for nulls every where, but I do in some of the more important places.&nbsp; I also import my own schema, because I was having problems pulling the schema down from other websites sometimes, and things weren't working right.

Lets have a look at the code:

<pre>&lt;%@ Control Language="C#" ClassName="BlogAgg" %&gt;&lt;%@ Import Namespace="System.Data" %&gt;&lt;script runat="server"&gt;    public string BlogRSSFeed = "";    public string BlogTitle = "";    protected void Page_Load(object sender, EventArgs e)    {        if (!IsPostBack)        {            if (BlogRSSFeed == "")                this.Visible = false;            else            {                try                {                    DataSet dsBlog = null;                    dsBlog = (DataSet)Cache.Get(BlogRSSFeed);                    if (dsBlog == null)                    {                        System.Net.WebProxy myProxy = new System.Net.WebProxy("http://MyProxy/", true);                        dsBlog = new DataSet();                        System.Net.WebRequest wr = System.Net.WebRequest.Create(BlogRSSFeed);                        wr.Proxy = myProxy;                        System.Net.WebResponse wresp = wr.GetResponse();                        dsBlog.ReadXmlSchema(Server.MapPath("~") + "\App_Data\rss_schema.xsd");                        dsBlog.ReadXml(wresp.GetResponseStream(), XmlReadMode.IgnoreSchema);                        Cache.Add(BlogRSSFeed, dsBlog, null, DateTime.Now.AddHours(1), System.Web.Caching.Cache.NoSlidingExpiration, CacheItemPriority.Normal, null);                    }                    hlTitleLink.Text = BlogTitle;                    if (dsBlog.Tables["channel"].Rows[0]["link"] != System.DBNull.Value)                        hlTitleLink.NavigateUrl = (string)dsBlog.Tables["channel"].Rows[0]["link"];                    hlTitleLink.Text = BlogTitle;                    hlTitle.Text = (string)dsBlog.Tables["item"].Rows[0]["title"];                    hlTitle.NavigateUrl = (string)dsBlog.Tables["item"].Rows[0]["link"];                    if (dsBlog.Tables["item"].Rows[0]["description"] != System.DBNull.Value)                        lblEntry.Text = (string)dsBlog.Tables["item"].Rows[0]["description"];                    else                        lblEntry.Text = "";                                        int iRows = 10;                    if (dsBlog.Tables["item"].Rows.Count &lt; iRows)                        iRows = dsBlog.Tables["item"].Rows.Count;                    LiteralControl lcStart = new LiteralControl("&lt;ul&gt;");                    pnlRecent.Controls.Add(lcStart);                    for (int i = 1; i &lt; iRows; i++)                    {                        LiteralControl lcOpen = new LiteralControl("&lt;li&gt;");                        LiteralControl lcClose = new LiteralControl("&lt;/li&gt;");                        HyperLink hl = new HyperLink();                        hl.Text = (string)dsBlog.Tables["item"].Rows[i]["Title"];                        hl.NavigateUrl = (string)dsBlog.Tables["item"].Rows[i]["link"];                        hl.Target = "_blank";                        pnlRecent.Controls.Add(lcOpen);                        pnlRecent.Controls.Add(hl);                        pnlRecent.Controls.Add(lcClose);                    }                    LiteralControl lcStop = new LiteralControl("&lt;/ul&gt;");                    pnlRecent.Controls.Add(lcStop);                }                catch (Exception ex)                {                    if ((Request.QueryString["debug"] != null) &amp;&amp; (Request.QueryString["debug"].ToLower().Equals("true")))                    {                        lblEntry.Text = ex.ToString();                    }                    else                    {                        this.Visible = false;                    }                }            }        }    }&lt;/script&gt;</pre>

And the HTML:

<pre>&lt;h2 class="title"&gt;    &lt;asp:HyperLink ID="hlTitleLink" runat="server"/&gt;&lt;/h2&gt;&lt;div id="BorderDiv"&gt;&lt;table&gt;    &lt;tr&gt;        &lt;td style="vertical-align:top; text-align:justify;" width="60%"&gt;            &lt;h2&gt;            &lt;asp:HyperLink ID="hlTitle" runat="server" Target="_blank" Text="No Recent Entries" /&gt;            &lt;/h2&gt;            &lt;asp:Label ID="lblEntry" style="text-align: justify;" runat="server" &gt;            &lt;/asp:Label&gt;        &lt;/td&gt;        &lt;td style="vertical-align:top;" width="40%"&gt;            &lt;h2&gt;                Previous Entries:&lt;/h2&gt;            &lt;asp:Panel ID="pnlRecent" runat="server" /&gt;                    &lt;/td&gt;    &lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</pre>

Overall, it's pretty simple, you can see an example at [http://www.nocommonground.com](http://www.nocommonground.com/)&nbsp; The photo user controls at the top are just a slight variation on this code, and do some special processing on the data that is handed back so it'll show the picture correctly.

Enjoy!